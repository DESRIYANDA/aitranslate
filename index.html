<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>AI Translate Tool</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 40px auto;
    }
    textarea {
      width: 100%;
      height: 120px;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      cursor: pointer;
    }
    input {
      margin: 10px 0;
    }
  </style>
</head>
<body>

<h2>ðŸ”¤ Translate Teks</h2>
<textarea id="inputText" placeholder="Masukkan teks Indonesia..."></textarea>
<button onclick="translateText()">Translate ke English</button>
<textarea id="outputText" placeholder="Hasil translate..." readonly></textarea>

<hr>

<h2>ðŸ“„ Translate CSV (kolom ke-2)</h2>
<input type="file" id="csvFile" accept=".csv">
<br>
<button onclick="translateCSV()">Translate CSV & Download</button>

<script src="https://js.puter.com/v2/"></script>
<script>
async function translateText() {
  const input = document.getElementById("inputText").value;
  if (!input) return alert("Teks kosong");

  const res = await puter.ai.translate({
    text: input,
    target_language: "en"
  });

  document.getElementById("outputText").value = res.text;
}

async function translateCSV() {
  const file = document.getElementById("csvFile").files[0];
  if (!file) return alert("Pilih file CSV dulu");

  const text = await file.text();
  const rows = text.split(/\r?\n/);
  const output = [];

  for (let i = 0; i < rows.length; i++) {
    if (!rows[i]) continue;

    const cols = rows[i].split(",");

    if (i === 0) {
      output.push(cols.concat(["translated_en"]).join(","));
      continue;
    }

    if (!cols[1]) {
      output.push(rows[i]);
      continue;
    }

    const res = await puter.ai.translate({
      text: cols[1],
      target_language: "en"
    });

    output.push(cols.concat([res.text.replace(/,/g, " ")]).join(","));
    await new Promise(r => setTimeout(r, 500));
  }

  const blob = new Blob([output.join("\n")], { type: "text/csv" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "translated.csv";
  a.click();
}
</script>

</body>
</html>
